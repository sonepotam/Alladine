      
             Программа получения аналитической отчетности.

Краткое описание:
Программа предназначена для получения аналитической отчетности, заранее
рассчитанной во внешних системах. Структура таблиц прилагается в  файле
struct.doc. Программа  позволяет  пользователю  самому  сконструировать
нужный отчет на основе аналитических данных.При расчете данные дробятся
по нескольким измерениям и заносятся в соответсвующую таблицу(кубик).

Предварительный расчет данных:
Внешняя  программа  заполняет  таблицу alRestInfo, в которой происходит
накопление остатков и оборотов в разрезе по кодам точки учета.Занесение
данных производится с помощью процедуры bp_al_PashkaCalculate, при этом
нужно учесть, что расчет выполняется порядка 15-20 минут. 
Расчет можно произвести с помощью скрипта:

declare
  dtStart DATE := to_Date( '01.12.2002', 'dd.mm.yyyy');
  dtStop  DATE := to_Date( '31.12.2002', 'dd.mm.yyyy');
begin
  bp_al_PashkaCalculate( dtStart, dtStop);
  commit;
end;
Назначение полей alRestInfo следующее:
Поле		Назначение
curDate		дата
depCode		код точки учета
balAccount	балансовый счет
CurrencyISO	код валюты
TypeRest	1 - остаток в валюте, 5 - в эквиваленте
Balance		остаток по счету
OBD, OBK	обороты по дебету и по кредиту


Идеология 

Пользователь описывает формулы, по которым производится расчет. При этом 
можно  использовать  следующие  знаки  операций (+)  и (-) и типы данных
D(остаток  по  дебету), K(остаток  по  кредиту), OBD(обороты по дебету),
OBK(обороты  по кредиту). В формулу заносится балансовый счет 2 порядка.
Примерный вид формулы:  42301D+42601D
Формула заносится в таблицу alFormula.

Формулы   объединяются   в   библиотеки.   В   библиотеку  может входить
произольное количество формул, порядок включения значения не имеет. 
Библиотеки хранятся в таблице alLibrary, список формул входящих в 
библиотеку хранится в таблице alLibraryContent.

При  создании  отчета пользователь выбирает тип отчета и вводит название
отчета.  Выбирая  тип  отчета  фактически  производится  выбор кубика, с
которым  будет связан отчет. Описание таблицы хранится в alTableDesc и в
alTableColumns.  Все  столбцы  кубика делятся на две категории измерения
(alTableColumns.ColumnType = 1) и факты (alTableColumns.ColumnType = 2).
Измерения позволяют "нарезать" данные определенными срезами, скажем по
датам. Факты - накопленные данные, их можно суммировать.

При настройке отчета пользователь перетаскивает мышью колонки из описания
кубика в графы Фильтр, Строка, Колонка, Факты.
Измерения можно перенести в Фильтр, Строка, Колонка. Факты можно перенести
в Фильтр, Факты.
Фильтры не видны в готовом отчете, они просто накладывают ограничения на
объем данных. Остальные графы, конечно, же видны.
При добавлении фактов ОБЯЗАТЕЛЬНО нужно ввести формулу расчета, по которой
он будет рассчитываться в отчете.

Полученный отчет можно эксортировать в Excel или в DBF-файл.




Клиентская часть:
- формулы добавляются Ins и удаляются по Del. Формул с одинаковым названием быть
не должно. Enter и DblClick позволяют редактировать содержимое формулы.
- библиотеки управляются теми же клавишами. Содержимое библиотеки изменяется
нажатим кнопочек > и <
- отчеты управляются теми же клавишами.
- колонки, строки, факты и фильтры удаляются по клавише Del. Добавляются 
перетаскиванием из описания кубика. Можно менять порядок строк, колонок и 
фактов.

 Пользователи и роли:
После заведения нового пользователя необходимо предоставить ему роль olap_user
grant connect, olap_user to <имя пользователя>;




